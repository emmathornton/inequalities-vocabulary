---
title: "R Notebook"
output:
  word_document: default
  html_document:
    df_print: paged
editor_options:
  chunk_output_type: console
---

Descriptive statistics for imputed data. first of all load in packages and custom functions. 
custom functions require imputed data to be in long format without the observed data included. 

```{r}
library(mice)
library(pander)
library(xtable)
library(dplyr)
library(gt)
library(glue)
library(miceadds)
library(swfscMisc)
library(imputools)
library(haven)
library(sjmisc)
library(Hmisc)
library(psych)
library(lavaan)
library(ggplot2)
library(ggpubr)
library(officer)
library(flextable)
library(ftExtra)
library(dummies)
library(tidyverse)
weighted_descriptives_imputed_datasets<- function (dataAll,variable) {
  variable=deparse(substitute(variable))
  imputed_datasets <- unique(dataAll$.imp)
  results <- data.frame(
    Mean = as.numeric(rep(0, length(imputed_datasets))),
    SD = as.numeric(rep(0, length(imputed_datasets))),
    lower=as.numeric(rep(0, length(imputed_datasets))),
    upper=as.numeric(rep(0, length(imputed_datasets))))
  results$Imputed <-  imputed_datasets
  for (i in 1:length(imputed_datasets)) {
    data <- dataAll[dataAll$.imp == imputed_datasets[i], ]
    results[i, "Mean"] <- get_weighted_descriptives(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[1]
    results[i, "SD"] <- get_weighted_descriptives(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[2]
    results[i, "lower"] <- get_weighted_descriptives(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[3]
    results[i, "upper"] <- get_weighted_descriptives(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[4]
  }
  return (results)
}
weighted_proportions_imputed_datasets<- function (dataAll,variable) {
  variable=deparse(substitute(variable))
  imputed_datasets <- unique(dataAll$.imp)
  results <- data.frame(
    Level1 = as.numeric(rep(0, length(imputed_datasets))),
    Level2 = as.numeric(rep(0, length(imputed_datasets))),
    Level3=as.numeric(rep(0, length(imputed_datasets))),
    Level4=as.numeric(rep(0, length(imputed_datasets))),
    Level5=as.numeric(rep(0, length(imputed_datasets))),
    Level6=as.numeric(rep(0, length(imputed_datasets))),
    Level7=as.numeric(rep(0, length(imputed_datasets))),
    Level8=as.numeric(rep(0, length(imputed_datasets))),
    Level9=as.numeric(rep(0, length(imputed_datasets))),
    Level10=as.numeric(rep(0, length(imputed_datasets))))
  results$Imputed <-  imputed_datasets
  for (i in 1:length(imputed_datasets)) {
    data <- dataAll[dataAll$.imp == imputed_datasets[i], ]
    results[i, "Level1"] <- get_weighted_proportions(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[1]
    results[i, "Level2"] <- get_weighted_proportions(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[2]
    results[i, "Level3"] <- get_weighted_proportions(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[3]
    results[i, "Level4"] <- get_weighted_proportions(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[4]
    results[i, "Level5"] <- get_weighted_proportions(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[5]
    results[i, "Level6"] <- get_weighted_proportions(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[6]
    results[i, "Level7"] <- get_weighted_proportions(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[7]
    results[i, "Level8"] <- get_weighted_proportions(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[8]
    results[i, "Level9"] <- get_weighted_proportions(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[9]
    results[i, "Level10"] <- get_weighted_proportions(eval(parse(text = paste("data",variable,sep="$"))), weights = data$mcs2_weight)[10]
    
  }
  return (results)
}

#Load in data

load("~/Documents/updated MCS datasets/inequalities datasets /2022-10-26_mcs_ses_imputedRQ1/2022-10-26_mcs_ses_imputedRQ1.Rdata")
imputed_mcs2=mi.res

#convert imputed data to long format without observed data
long_format_mcs <- mice::complete(imputed_mcs2, "long", include=FALSE)
#redorder nvq and occupational status to have same order as whole cohort data - for occupational status and nvq
long_format_mcs$highest_nvq = factor(long_format_mcs$highest_NVQ, levels = c("1", "2", "3", "4", "5", "0"))
long_format_mcs$occupational_status = factor(long_format_mcs$occupational_status, levels = c( "2", "3", "4", "1"))


```

run descritpives
```{r include = FALSE}
#numeric variables - means & SDs
#calculate descriptives across imputed datasets
vocab_age3Descriptives = weighted_descriptives_imputed_datasets(long_format_mcs, vocabulary_age3)
vocab_age5Descriptives = weighted_descriptives_imputed_datasets(long_format_mcs, vocabulary_age5)
vocab_age11Descriptives = weighted_descriptives_imputed_datasets(long_format_mcs, vocabulary_age11)
vocab_age14Descriptives = weighted_descriptives_imputed_datasets(long_format_mcs, vocabulary_age14)

#combine across imputed datasets
combined_vocab_age3Descriptives = round(combine_imputed_descriptives(vocab_age3Descriptives),2) %>% 
  select(!Imputed) %>% 
  slice_head(n=1) 

combined_vocab_age5Descriptives = round(combine_imputed_descriptives(vocab_age5Descriptives),2) %>% 
  select(!Imputed) %>% 
  slice_head(n=1) 

combined_vocab_age11Descriptives = round(combine_imputed_descriptives(vocab_age11Descriptives),2) %>% 
  select(!Imputed) %>% 
  slice_head(n=1) 

combined_vocab_age14Descriptives = round(combine_imputed_descriptives(vocab_age14Descriptives),2) %>% 
  select(!Imputed) %>% 
  slice_head(n=1) 

#categorical variables: proportions
sexProportions = weighted_proportions_imputed_datasets(long_format_mcs, gender) %>% 
  select(Level1:Level2) 
ethnicityProportions = weighted_proportions_imputed_datasets(long_format_mcs, ethnicity) %>% 
  select(Level1:Level6) 
ealProportions = weighted_proportions_imputed_datasets(long_format_mcs, language_used_at_home) %>% 
  select(Level1:Level3) 
nvqProportions = weighted_proportions_imputed_datasets(long_format_mcs, highest_NVQ) %>% 
  select(Level1:Level6) 
incomeProportions = weighted_proportions_imputed_datasets(long_format_mcs, income_quintiles) %>% 
  select(Level1:Level5) 
occupationProportions = weighted_proportions_imputed_datasets(long_format_mcs, occupational_status) %>% 
  select(Level1:Level4) 
wealthProportions = weighted_proportions_imputed_datasets(long_format_mcs, wealth_quintiles) %>% 
  select(Level1:Level5)  
imdProportions = weighted_proportions_imputed_datasets(long_format_mcs, imd) %>% 
  select(Level1:Level10)  

 
sexCombined = round(combine_imputed_descriptives(sexProportions)*100, 2) %>% 
  slice_head(n=1) %>% 
  rename("Sex (Male)" = Level1,
         "Sex (Female)" = Level2) 
sexCombined = as.data.frame(t(sexCombined)) %>% 
  rownames_to_column() %>% 
  rename("Variable" = rowname,
         "Proportion (%) or \n Mean(±SD) [95% CIs]" = V1) 
ethnicityCombined = round(combine_imputed_descriptives(ethnicityProportions)*100,2)%>% 
  slice_head(n=1) %>% 
  rename( "Ethnicity \n (White)" = Level1, 
          "Ethnicity \n (mixed)" = Level2,
          "Ethnicity \n (Indian)" = Level3, 
          "Ethnicity \n (Pakistani & Bangladeshi)" = Level4, 
          "Ethnicity \n (Black/ Black British)" = Level5, 
          "Ethnicity \n (other incl. Chinese)" = Level6)
ethnicityCombined = as.data.frame(t(ethnicityCombined)) %>% 
  rownames_to_column() %>% 
  rename("Variable" = rowname,
         "Proportion (%) or \n Mean(±SD) [95% CIs]" = V1) 
ealCombined = round(combine_imputed_descriptives(ealProportions)*100,2)%>% 
  slice_head(n=1) %>% 
  rename("EAL \n (English only)" = Level1, 
         "EAL \n (English and another language)" = Level2,
         "EAL \n (only another language)" = Level3)
ealCombined = as.data.frame(t(ealCombined)) %>% 
  rownames_to_column() %>% 
  rename("Variable" = rowname,
         "Proportion (%) or \n Mean(±SD) [95% CIs]" = V1) 
nvqCombined = round(combine_imputed_descriptives(nvqProportions)*100,2)%>% 
  slice_head(n=1) %>% 
  rename("Parent Education \n (NVQ1)" = Level1, 
         "Parent Education \n (NVQ2)"= Level2, 
         "Parent Education \n (NVQ3)" = Level3,
         "Parent Education \n (NVQ4)" = Level4,
         "Parent Education \n (NVQ5)" = Level5,
         "Parent Education \n (None of these/overseas qualifications)" = Level6)
nvqCombined = as.data.frame(t(nvqCombined)) %>% 
  rownames_to_column() %>% 
  rename("Variable" = rowname,
         "Proportion (%) or \n Mean(±SD) [95% CIs]" = V1) 
incomeCombined = round(combine_imputed_descriptives(incomeProportions)*100,2)%>% 
  slice_head(n=1) %>% 
  rename("Income Quintile 1" = Level1, 
         "Income Quintile 2" = Level2, 
         "Income Quintile 3" = Level3, 
         "Income Quintile 4" = Level4 , 
         "Income Quintile 5" = Level5)
incomeCombined = as.data.frame(t(incomeCombined)) %>% 
  rownames_to_column() %>% 
  rename("Variable" = rowname,
         "Proportion (%) or \n Mean(±SD) [95% CIs]" = V1) 
occupationCombined = round(combine_imputed_descriptives(occupationProportions)*100,2)%>% 
  slice_head(n=1) %>% 
  rename("Occupational Status \n (routine)" = Level1, 
         "Occupational Status \n (intermediate)" = Level2,
         "Occupational Status \n (higher managerial)" = Level3,
         "Occupational Status \n (unemployed)" = Level4)
occupationCombined = as.data.frame(t(occupationCombined)) %>% 
  rownames_to_column() %>% 
  rename("Variable" = rowname,
         "Proportion (%) or \n Mean(±SD) [95% CIs]" = V1) 
wealthCombined = round(combine_imputed_descriptives(wealthProportions)*100,2)%>% 
  slice_head(n=1) %>% 
  rename("Wealth Quintile 1" = Level1, 
         "Wealth Quintile 2" = Level2, 
         "Wealth Quintile 3" = Level3, 
         "Wealth Quintile 4" = Level4, 
         "Wealth Quintile 5" = Level5)
wealthCombined = as.data.frame(t(wealthCombined)) %>% 
  rownames_to_column() %>% 
  rename("Variable" = rowname,
         "Proportion (%) or \n Mean(±SD) [95% CIs]" = V1) 
imdCombined = round(combine_imputed_descriptives(imdProportions)*100,2)%>% 
  slice_head(n=1) %>% 
  rename("Relative Neighbourhood Deprivation \n (most deprived decile)" = Level1, 
         "Relative Neighbourhood Deprivation \n (10 - <20%)" = Level2, 
         "Relative Neighbourhood Deprivation \n (20 - <30%)" = Level3, 
         "Relative Neighbourhood Deprivation \n (30 - <40%)" = Level4, 
         "Relative Neighbourhood Deprivation \n (40 - <50%)" = Level5, 
         "Relative Neighbourhood Deprivation \n (50 - <60%)" = Level6, 
         "Relative Neighbourhood Deprivation \n (60 - <70%)" = Level7, 
         "Relative Neighbourhood Deprivation \n (70 - <80%)" = Level8, 
         "Relative Neighbourhood Deprivation \n (80 - <90%)"= Level9,
         "Relative Neighbourhood Deprivation \n (least deprived decile)" = Level10)
imdCombined = as.data.frame(t(imdCombined)) %>% 
  rownames_to_column() %>% 
  rename("Variable" = rowname,
         "Proportion (%) or \n Mean(±SD) [95% CIs]" = V1) 
```

prepare for table.
will need to paste in 95%CIs with means and SDs and then put everything into one dataframe
```{r}
vocabulary_age3Descriptives = combined_vocab_age3Descriptives %>% add_column(paste0(combined_vocab_age3Descriptives$Mean,"(±",combined_vocab_age3Descriptives$SD,")", "\n", "[", combined_vocab_age3Descriptives$lower, ";", combined_vocab_age3Descriptives$upper,"]")) %>% 
  rename("cmVocabAge3" = `paste0(...)`) %>% 
  add_column("Variable" = "Cohort Member Vocabulary \n Age 3 (Naming Vocabulary Score)") %>% 
  select(Variable, cmVocabAge3)  %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = cmVocabAge3) 


vocabulary_age5Descriptives = combined_vocab_age5Descriptives %>% add_column(paste0(combined_vocab_age5Descriptives$Mean,"(±",combined_vocab_age5Descriptives$SD,")", "\n", "[", combined_vocab_age5Descriptives$lower, ";", combined_vocab_age5Descriptives$upper,"]")) %>% 
  rename("cmVocabAge5" = `paste0(...)`) %>% 
  add_column("Variable" = "Cohort Member Vocabulary \n Age 5 (Naming Vocabulary Score)") %>% 
  select(Variable, cmVocabAge5)  %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = cmVocabAge5) 

vocabulary_age11Descriptives = combined_vocab_age11Descriptives %>% add_column(paste0(combined_vocab_age11Descriptives$Mean,"(±",combined_vocab_age11Descriptives$SD,")", "\n", "[", combined_vocab_age11Descriptives$lower, ";", combined_vocab_age11Descriptives$upper,"]")) %>% 
  rename("cmVocabAge11" = `paste0(...)`) %>% 
  add_column("Variable" = "Cohort Member Vocabulary \n Age 11 (Verbal Similarities Score)") %>% 
  select(Variable, cmVocabAge11)  %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = cmVocabAge11) 

vocabulary_age14Descriptives = combined_vocab_age14Descriptives %>% add_column(paste0(combined_vocab_age14Descriptives$Mean,"(±",combined_vocab_age14Descriptives$SD,")", "\n", "[", combined_vocab_age14Descriptives$lower, ";", combined_vocab_age14Descriptives$upper,"]")) %>% 
  rename("cmVocabAge14" = `paste0(...)`) %>% 
  add_column("Variable" = "Cohort Member Vocabulary \n Age 14 (Word Activity Test Score)") %>% 
  select(Variable, cmVocabAge14)  %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = cmVocabAge14) 

#put into one overall dataframe that can then  put into flex table
descriptivesTable = rbind(vocabulary_age3Descriptives, vocabulary_age5Descriptives,
                          vocabulary_age11Descriptives, vocabulary_age14Descriptives,
                          sexCombined, ethnicityCombined, ealCombined, 
                          nvqCombined, incomeCombined, wealthCombined, occupationCombined,
                          imdCombined) %>% 
  add_row(Variable = "Vocabulary", .before = 1) %>%  #add in rows to divide table up 
  add_row(Variable = "Demographics", .before = 6) %>% 
  add_row(Variable = "Socioeconomic Circumstances", .before = 18)
descriptivesTable [is.na(descriptivesTable )] <- " "

```

whole cohort descriptives , so can compare full cohort to analytic sample. 

```{r}
#read in full cohort data
mcs_cohort<-read.csv("SES_data.csv")
mcs_cohort[,1]<- NULL
#redorder nvq and occupational status variables 
mcs_cohort$highest_nvq = factor(mcs_cohort$highest_NVQ, levels = c("1", "2", "3", "4", "5", "0"))
mcs_cohort$occupational_status = factor(mcs_cohort$occupational_status, levels = c( "2", "3", "4", "1"))
#get weighted proportions - need to remove NA values 
#sex
cohort_sex = round(get_weighted_proportions(mcs_cohort[!is.na(mcs_cohort$gender),]$gender,
                         mcs_cohort[!is.na(mcs_cohort$gender),]$mcs2_weight)*100, 2)
cohort_sex = as_tibble(cohort_sex) %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = value) %>% 
  add_column(Variable = c("Sex (Male)", "Sex (Female)"), .before = 1) 
  
#ethnicity
cohort_ethnicity = round(get_weighted_proportions(mcs_cohort[!is.na(mcs_cohort$ethnicity),]$ethnicity,
                         mcs_cohort[!is.na(mcs_cohort$ethnicity),]$mcs2_weight)*100,2)
cohort_ethnicity = as_tibble(cohort_ethnicity) %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = value) %>% 
           add_column(Variable = c("Ethnicity \n (White)",
                                   "Ethnicity \n (mixed)",
                                   "Ethnicity \n (Indian)",
                                   "Ethnicity \n (Pakistani & Bangladeshi)",
                                   "Ethnicity \n (Black/ Black British)",
                                   "Ethnicity \n (other incl. Chinese)"), .before = 1)
#EAL
cohort_eal = round(get_weighted_proportions(mcs_cohort[!is.na(mcs_cohort$language_used_at_home),]$language_used_at_home,
                         mcs_cohort[!is.na(mcs_cohort$language_used_at_home),]$mcs2_weight)*100,2)
cohort_eal = as_tibble(cohort_eal) %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = value) %>% 
           add_column(Variable = c("EAL \n (English only)", 
                                   "EAL \n (English and another language)",
                                   "EAL \n (only another language)"), .before = 1)

#NVQ
mcs_cohort$highest_nvq = as.factor(mcs_cohort$highest_nvq)
mcs_cohort$highest_nvq = relevel(mcs_cohort$highest_nvq, ref = "1")
cohort_nvq = round(get_weighted_proportions(mcs_cohort[!is.na(mcs_cohort$highest_nvq),]$highest_nvq,
                         mcs_cohort[!is.na(mcs_cohort$highest_nvq),]$mcs2_weight)*100,2)
cohort_nvq =  as_tibble(cohort_nvq) %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = value) %>% 
           add_column(Variable = c("Parent Education \n (NVQ1)",
                                   "Parent Education \n (NVQ2)",
                                   "Parent Education \n (NVQ3)",
                                   "Parent Education \n (NVQ4)", 
                                   "Parent Education \n (NVQ5)",
                                   "Parent Education \n (None of these/overseas qualifications)"), .before = 1)
#income
cohort_income = round(get_weighted_proportions(mcs_cohort[!is.na(mcs_cohort$income_quintiles),]$income_quintiles,
                         mcs_cohort[!is.na(mcs_cohort$income_quintiles),]$mcs2_weight)*100,2)
cohort_income =  as_tibble(cohort_income) %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = value) %>% 
           add_column(Variable = c("Income Quintile 1",
                                   "Income Quintile 2", 
                                   "Income Quintile 3", 
                                   "Income Quintile 4", 
                                   "Income Quintile 5"), .before = 1)
#occupational status
mcs_cohort$occupational_status = as.factor(mcs_cohort$occupational_status)
mcs_cohort$occupational_status = relevel(mcs_cohort$occupational_status, ref = "2")
cohort_occupation = round(get_weighted_proportions(mcs_cohort[!is.na(mcs_cohort$occupational_status),]$occupational_status,
                         mcs_cohort[!is.na(mcs_cohort$occupational_status),]$mcs2_weight)*100,2)
cohort_occupation =  as_tibble(cohort_occupation) %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = value) %>% 
           add_column(Variable = c("Occupational Status \n (routine)",
                                   "Occupational Status \n (intermediate)",
                                   "Occupational Status \n (higher managerial)",
                                    "Occupational Status \n (unemployed)"), .before = 1)
#imd
cohort_imd = round(get_weighted_proportions(mcs_cohort[!is.na(mcs_cohort$imd),]$imd,
                         mcs_cohort[!is.na(mcs_cohort$imd),]$mcs2_weight)*100,2)
cohort_imd =  as_tibble(cohort_imd) %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = value) %>% 
           add_column(Variable = c("Relative Neighbourhood Deprivation \n (most deprived decile)", 
                                   "Relative Neighbourhood Deprivation \n (10 - <20%)",
                                   "Relative Neighbourhood Deprivation \n (20 - <30%)", 
                                   "Relative Neighbourhood Deprivation \n (30 - <40%)", 
                                   "Relative Neighbourhood Deprivation \n (40 - <50%)", 
                                   "Relative Neighbourhood Deprivation \n (50 - <60%)", 
                                   "Relative Neighbourhood Deprivation \n (60 - <70%)", 
                                   "Relative Neighbourhood Deprivation \n (70 - <80%)", 
                                   "Relative Neighbourhood Deprivation \n (80 - <90%)",
                                   "Relative Neighbourhood Deprivation \n (least deprived decile)"), .before = 1)

#means and SDs
#vocabulary
#Age 3
cohort_vocabAge3 = round(get_weighted_descriptives(mcs_cohort[!is.na(mcs_cohort$vocabulary_age3),]$vocabulary_age3,
                          mcs_cohort[!is.na(mcs_cohort$vocabulary_age3),]$mcs2_weight),2)
cohort_vocabAge3 = as.data.frame(t(cohort_vocabAge3)) %>% 
  rename("mean" = V1, 
         "sd" = V2, 
         "lower" = V3, 
         "upper" = V4) 
cohort_vocabAge3 = cohort_vocabAge3 %>% add_column(paste0(cohort_vocabAge3$mean,"(±",cohort_vocabAge3$sd,")", 
                                                  "\n", "[", cohort_vocabAge3$lower, ";", cohort_vocabAge3$upper,"]")) %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = `paste0(...)`) %>% 
  select(`Proportion (%) or \n Mean(±SD) [95% CIs]`) %>% 
  add_column(Variable = c("Cohort Member Vocabulary \n Age 3 (Naming Vocabulary Score)"), .before = 1)

#Age 5  
cohort_vocabAge5 = round(get_weighted_descriptives(mcs_cohort[!is.na(mcs_cohort$vocabulary_age5),]$vocabulary_age5,
                                                   mcs_cohort[!is.na(mcs_cohort$vocabulary_age5),]$mcs2_weight),2)
cohort_vocabAge5 = as.data.frame(t(cohort_vocabAge5)) %>% 
  rename("mean" = V1, 
         "sd" = V2, 
         "lower" = V3, 
         "upper" = V4) 
cohort_vocabAge5 = cohort_vocabAge5 %>% add_column(paste0(cohort_vocabAge5$mean,"(±",cohort_vocabAge5$sd,")", 
                                                          "\n", "[", cohort_vocabAge5$lower, ";", cohort_vocabAge5$upper,"]")) %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = `paste0(...)`) %>% 
  select(`Proportion (%) or \n Mean(±SD) [95% CIs]`) %>% 
  add_column(Variable = c("Cohort Member Vocabulary \n Age 5 (Naming Vocabulary Score)"), .before = 1)

#Age 11 
cohort_vocabAge11 = round(get_weighted_descriptives(mcs_cohort[!is.na(mcs_cohort$vocabulary_age11),]$vocabulary_age11,
                                                   mcs_cohort[!is.na(mcs_cohort$vocabulary_age11),]$mcs2_weight),2)
cohort_vocabAge11 = as.data.frame(t(cohort_vocabAge11)) %>% 
  rename("mean" = V1, 
         "sd" = V2, 
         "lower" = V3, 
         "upper" = V4) 
cohort_vocabAge11 = cohort_vocabAge11 %>% add_column(paste0(cohort_vocabAge11$mean,"(±",cohort_vocabAge11$sd,")", 
                                                          "\n", "[", cohort_vocabAge11$lower, ";", cohort_vocabAge11$upper,"]")) %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = `paste0(...)`) %>% 
  select(`Proportion (%) or \n Mean(±SD) [95% CIs]`) %>% 
  add_column(Variable = c("Cohort Member Vocabulary \n Age 11 (Word Similarities Score)"), .before = 1)

#Age 14
cohort_vocabAge14 = round(get_weighted_descriptives(mcs_cohort[!is.na(mcs_cohort$vocabulary_age14),]$vocabulary_age14,
                                                   mcs_cohort[!is.na(mcs_cohort$vocabulary_age14),]$mcs2_weight),2)
cohort_vocabAge14 = as.data.frame(t(cohort_vocabAge14)) %>% 
  rename("mean" = V1, 
         "sd" = V2, 
         "lower" = V3, 
         "upper" = V4) 
cohort_vocabAge14 = cohort_vocabAge14 %>% add_column(paste0(cohort_vocabAge14$mean,"(±",cohort_vocabAge14$sd,")", 
                                                          "\n", "[", cohort_vocabAge14$lower, ";", cohort_vocabAge14$upper,"]")) %>% 
  rename("Proportion (%) or \n Mean(±SD) [95% CIs]" = `paste0(...)`) %>% 
  select(`Proportion (%) or \n Mean(±SD) [95% CIs]`) %>% 
  add_column(Variable = c("Cohort Member Vocabulary \n Age 14 (Word Activity Tast Score)"), .before = 1)

descriptivesCohort = rbind(cohort_vocabAge3, cohort_vocabAge5, 
                           cohort_vocabAge11, cohort_vocabAge14, 
                          cohort_sex, cohort_ethnicity, cohort_eal,
                          cohort_nvq, cohort_income, cohort_occupation, cohort_imd) %>% 
  add_row(Variable = "Vocabulary", .before = 1) %>%  #add in rows to divide table up 
  add_row(Variable = "Demographics", .before = 6) %>% 
  add_row(Variable = "Socioeconomic Circumstances", .before = 18) %>% 
  add_row(Variable = "Wealth Quintile 1", .after = 33) %>% 
  add_row(Variable = "Wealth Quintile 2", .after = 34) %>% 
  add_row(Variable = "Wealth Quintile 3", .after = 35) %>% 
  add_row(Variable = "Wealth Quintile 4", .after = 36) %>% 
  add_row(Variable = "Wealth Quintile 5", .after = 37) 
    
descriptivesCohort [is.na(descriptivesCohort )] <- " "
```

combine analytical sample and full cohort descriptives
```{r}
fullDescriptives = cbind(descriptivesCohort, descriptivesTable)
names(fullDescriptives) = c("Variable" , "Full Cohort", "Var", "Analytical Sample")
fullDescriptives = fullDescriptives %>% select(!Var)
#put into table
#define border
my_border = border= fp_border(color="black", width=1)
full_descriptives <- fullDescriptives %>% 
  flextable() %>% 
  font(fontname = "Times New Roman", part="all") %>% #
  fontsize(size=10, part = "all") %>% #
  align(j=1, align="left", part="all") %>% 
  align(j=2:3, align="center", part="all") %>% 
  color(j=1:3, color="black", part="all") %>% 
  width(j=1, width=2) %>% 
  width(j=2:3, width=1.8) %>% 
  line_spacing(j=2:3, space=1.5) %>% 
  line_spacing(j=1, space=1.5) %>% 
  border_remove() %>% 
  hline_top(j=1:3, part="all", border=my_border) %>% 
  hline_bottom(j=1:3,part="body",  border=my_border) %>% 
  bold(j = 1, i = c(1,6,18), bold = TRUE) %>% 
  italic(j = 1, i = c(1,6,18), italic = TRUE) %>% 
  set_header_labels(Variable= "Variable", `Full Cohort` = "Whole Cohort \n (N= 19243)", 
                    `Analytical Sample` = "Analytical Sample (N=17,070)") %>% 
  add_header_row(values = c(" ", "Proportion (%) or \n Mean(±SD) [95% CIs]" ), colwidths = c(1, 2)) %>% 
  font(fontname = "Times New Roman", part="header") %>% 
  align(align="center", part="header") %>% 
  hline_top(j = 2:3, part = "all", border = my_border)  %>% 
  font(fontname = "Times New Roman", part = "footer") %>% 
  fontsize(size = 9, part = "footer") %>% 
  italic(part = "footer", italic = TRUE) %>% 
  align(align="left", part="footer") %>% 
  add_header_lines(values = c("Table 2: Descriptive Statistics for Analytical Sample (N = 17, 070) and Whole MCS2001 Cohort (N=19,243)")) %>% 
  font(fontname = "Times New Roman", part = "header") %>% 
  fontsize(size = 12, part = "header") %>% 
  italic(part = "header", italic = TRUE)
  

 print(full_descriptives, preview = "docx") 
```


create flextable for descriptives
```{r}
#define border
my_border = border= fp_border(color="black", width=1)
descriptives_table <- descriptivesTable %>% 
  flextable() %>% 
  font(fontname = "Times New Roman", part="all") %>% #
  fontsize(size=10, part = "all") %>% #
  align(j=1, align="left", part="all") %>% 
  align(j=2, align="center", part="all") %>% 
  color(j=1:2, color="black", part="all") %>% 
  width(j=1, width=2) %>% 
  width(j=2, width=1.8) %>% 
  line_spacing(j=2, space=1.5) %>% 
  line_spacing(j=1, space=1.5) %>% 
  border_remove() %>% 
  hline_top(j=1:2, part="all", border=my_border) %>% 
  hline_bottom(j=1:2,part="body",  border=my_border) %>% 
  bold(j = 1, i = c(1,6,18), bold = TRUE) %>% 
  italic(j = 1, i = c(1,6,18), italic = TRUE) 
  
  
 print(descriptives_table, preview = "docx") 
```


# Language Descriptives in each SES group 

now we need to split our data up by each ses group to get the descriptive language scores for each group. 
this needs to be done for language at each age. 

```{r}
# NVQ ####
#separate out each NVQ group
NVQ0 <- filter(long_format_mcs, highest_NVQ == "0") 
NVQ1 <- filter(long_format_mcs, highest_NVQ == "1") 
NVQ2 <- filter(long_format_mcs, highest_NVQ == "2") 
NVQ3 <- filter(long_format_mcs, highest_NVQ == "3") 
NVQ4 <- filter(long_format_mcs, highest_NVQ == "4") 
NVQ5 <- filter(long_format_mcs, highest_NVQ == "5") 
#calculate mean per group across imputed datasets: age 3
age3_NVQ0 <- weighted_descriptives_imputed_datasets(NVQ0, vocabulary_age3)
age3_NVQ1 <- weighted_descriptives_imputed_datasets(NVQ1, vocabulary_age3)
age3_NVQ2 <- weighted_descriptives_imputed_datasets(NVQ2, vocabulary_age3)
age3_NVQ3 <- weighted_descriptives_imputed_datasets(NVQ3, vocabulary_age3)
age3_NVQ4 <- weighted_descriptives_imputed_datasets(NVQ4, vocabulary_age3)
age3_NVQ5 <- weighted_descriptives_imputed_datasets(NVQ5, vocabulary_age3)
#combine descriptives across datasets to give poooled value: age 3
age3_NVQ0_combined <- combine_imputed_descriptives(age3_NVQ0)
age3_NVQ1_combined <- combine_imputed_descriptives(age3_NVQ1)
age3_NVQ2_combined <- combine_imputed_descriptives(age3_NVQ2)
age3_NVQ3_combined <- combine_imputed_descriptives(age3_NVQ3)
age3_NVQ4_combined <- combine_imputed_descriptives(age3_NVQ4)
age3_NVQ5_combined <- combine_imputed_descriptives(age3_NVQ5)

#calculate mean per group across imputed datasets: age 5
age5_NVQ0 <- weighted_descriptives_imputed_datasets(NVQ0, vocabulary_age5)
age5_NVQ1 <- weighted_descriptives_imputed_datasets(NVQ1, vocabulary_age5)
age5_NVQ2 <- weighted_descriptives_imputed_datasets(NVQ2, vocabulary_age5)
age5_NVQ3 <- weighted_descriptives_imputed_datasets(NVQ3, vocabulary_age5)
age5_NVQ4 <- weighted_descriptives_imputed_datasets(NVQ4, vocabulary_age5)
age5_NVQ5 <- weighted_descriptives_imputed_datasets(NVQ5, vocabulary_age5)
#combine descriptives across datasets to give poooled value: age 5
age5_NVQ0_combined <- combine_imputed_descriptives(age5_NVQ0)
age5_NVQ1_combined <- combine_imputed_descriptives(age5_NVQ1)
age5_NVQ2_combined <- combine_imputed_descriptives(age5_NVQ2)
age5_NVQ3_combined <- combine_imputed_descriptives(age5_NVQ3)
age5_NVQ4_combined <- combine_imputed_descriptives(age5_NVQ4)
age5_NVQ5_combined <- combine_imputed_descriptives(age5_NVQ5)

#calculate mean per group across imputed datasets: age 11
age11_NVQ0 <- weighted_descriptives_imputed_datasets(NVQ0, vocabulary_age11)
age11_NVQ1 <- weighted_descriptives_imputed_datasets(NVQ1, vocabulary_age11)
age11_NVQ2 <- weighted_descriptives_imputed_datasets(NVQ2, vocabulary_age11)
age11_NVQ3 <- weighted_descriptives_imputed_datasets(NVQ3, vocabulary_age11)
age11_NVQ4 <- weighted_descriptives_imputed_datasets(NVQ4, vocabulary_age11)
age11_NVQ5 <- weighted_descriptives_imputed_datasets(NVQ5, vocabulary_age11)
#combine descriptives across datasets to give poooled value: age 11
age11_NVQ0_combined <- combine_imputed_descriptives(age11_NVQ0)
age11_NVQ1_combined <- combine_imputed_descriptives(age11_NVQ1)
age11_NVQ2_combined <- combine_imputed_descriptives(age11_NVQ2)
age11_NVQ3_combined <- combine_imputed_descriptives(age11_NVQ3)
age11_NVQ4_combined <- combine_imputed_descriptives(age11_NVQ4)
age11_NVQ5_combined <- combine_imputed_descriptives(age11_NVQ5)

#calculate mean per group across imputed datasets: age 14
age14_NVQ0 <- weighted_descriptives_imputed_datasets(NVQ0, vocabulary_age14)
age14_NVQ1 <- weighted_descriptives_imputed_datasets(NVQ1, vocabulary_age14)
age14_NVQ2 <- weighted_descriptives_imputed_datasets(NVQ2, vocabulary_age14)
age14_NVQ3 <- weighted_descriptives_imputed_datasets(NVQ3, vocabulary_age14)
age14_NVQ4 <- weighted_descriptives_imputed_datasets(NVQ4, vocabulary_age14)
age14_NVQ5 <- weighted_descriptives_imputed_datasets(NVQ5, vocabulary_age14)
#combine descriptives across datasets to give poooled value: age 14
age14_NVQ0_combined <- combine_imputed_descriptives(age14_NVQ0)
age14_NVQ1_combined <- combine_imputed_descriptives(age14_NVQ1)
age14_NVQ2_combined <- combine_imputed_descriptives(age14_NVQ2)
age14_NVQ3_combined <- combine_imputed_descriptives(age14_NVQ3)
age14_NVQ4_combined <- combine_imputed_descriptives(age14_NVQ4)
age14_NVQ5_combined <- combine_imputed_descriptives(age14_NVQ5)


#INCOME####
#separate out each income quintile
income1 <- filter(long_format_mcs, income_quintiles == "1") 
income2 <- filter(long_format_mcs, income_quintiles == "2") 
income3 <- filter(long_format_mcs, income_quintiles == "3") 
income4 <- filter(long_format_mcs, income_quintiles == "4") 
income5 <- filter(long_format_mcs, income_quintiles == "5")

#calculate mean per group across imputed datasets: age 3
age3_income1 <- weighted_descriptives_imputed_datasets(income1, vocabulary_age3)
age3_income2 <- weighted_descriptives_imputed_datasets(income2, vocabulary_age3)
age3_income3 <- weighted_descriptives_imputed_datasets(income3, vocabulary_age3)
age3_income4 <- weighted_descriptives_imputed_datasets(income4, vocabulary_age3)
age3_income5 <- weighted_descriptives_imputed_datasets(income5, vocabulary_age3)
#combine descriptives across datasets to give poooled value: age 3
age3_income1_combined <- combine_imputed_descriptives(age3_income1)
age3_income2_combined <- combine_imputed_descriptives(age3_income2)
age3_income3_combined <- combine_imputed_descriptives(age3_income3)
age3_income4_combined <- combine_imputed_descriptives(age3_income4)
age3_income5_combined <- combine_imputed_descriptives(age3_income5)

#calculate mean per group across imputed datasets: age 5
age5_income1 <- weighted_descriptives_imputed_datasets(income1, vocabulary_age5)
age5_income2 <- weighted_descriptives_imputed_datasets(income2, vocabulary_age5)
age5_income3 <- weighted_descriptives_imputed_datasets(income3, vocabulary_age5)
age5_income4 <- weighted_descriptives_imputed_datasets(income4, vocabulary_age5)
age5_income5 <- weighted_descriptives_imputed_datasets(income5, vocabulary_age5)
#combine descriptives across datasets to give poooled value: age 5
age5_income1_combined <- combine_imputed_descriptives(age5_income1)
age5_income2_combined <- combine_imputed_descriptives(age5_income2)
age5_income3_combined <- combine_imputed_descriptives(age5_income3)
age5_income4_combined <- combine_imputed_descriptives(age5_income4)
age5_income5_combined <- combine_imputed_descriptives(age5_income5)

#calculate mean per group across imputed datasets: age 11
age11_income1 <- weighted_descriptives_imputed_datasets(income1, vocabulary_age11)
age11_income2 <- weighted_descriptives_imputed_datasets(income2, vocabulary_age11)
age11_income3 <- weighted_descriptives_imputed_datasets(income3, vocabulary_age11)
age11_income4 <- weighted_descriptives_imputed_datasets(income4, vocabulary_age11)
age11_income5 <- weighted_descriptives_imputed_datasets(income5, vocabulary_age11)
#combine descriptives across datasets to give poooled value: age 11
age11_income1_combined <- combine_imputed_descriptives(age11_income1)
age11_income2_combined <- combine_imputed_descriptives(age11_income2)
age11_income3_combined <- combine_imputed_descriptives(age11_income3)
age11_income4_combined <- combine_imputed_descriptives(age11_income4)
age11_income5_combined <- combine_imputed_descriptives(age11_income5)

#calculate mean per group across imputed datasets: age 14
age14_income1 <- weighted_descriptives_imputed_datasets(income1, vocabulary_age14)
age14_income2 <- weighted_descriptives_imputed_datasets(income2, vocabulary_age14)
age14_income3 <- weighted_descriptives_imputed_datasets(income3, vocabulary_age14)
age14_income4 <- weighted_descriptives_imputed_datasets(income4, vocabulary_age14)
age14_income5 <- weighted_descriptives_imputed_datasets(income5, vocabulary_age14)
#combine descriptives across datasets to give poooled value: age 14
age14_income1_combined <- combine_imputed_descriptives(age14_income1)
age14_income2_combined <- combine_imputed_descriptives(age14_income2)
age14_income3_combined <- combine_imputed_descriptives(age14_income3)
age14_income4_combined <- combine_imputed_descriptives(age14_income4)
age14_income5_combined <- combine_imputed_descriptives(age14_income5)

#WEALTH####
#separate out each wealth quintile
wealth1 <- filter(long_format_mcs, wealth_quintiles == "1") 
wealth2 <- filter(long_format_mcs, wealth_quintiles == "2") 
wealth3 <- filter(long_format_mcs, wealth_quintiles == "3") 
wealth4 <- filter(long_format_mcs, wealth_quintiles == "4") 
wealth5 <- filter(long_format_mcs, wealth_quintiles == "5")
#calculate mean per group across imputed datasets: age 3
age3_wealth1 <- weighted_descriptives_imputed_datasets(wealth1, vocabulary_age3)
age3_wealth2 <- weighted_descriptives_imputed_datasets(wealth2, vocabulary_age3)
age3_wealth3 <- weighted_descriptives_imputed_datasets(wealth3, vocabulary_age3)
age3_wealth4 <- weighted_descriptives_imputed_datasets(wealth4, vocabulary_age3)
age3_wealth5 <- weighted_descriptives_imputed_datasets(wealth5, vocabulary_age3)
#combine descriptives across datasets to give poooled value: age 3
age3_wealth1_combined <- combine_imputed_descriptives(age3_wealth1)
age3_wealth2_combined <-combine_imputed_descriptives(age3_wealth2)
age3_wealth3_combined <-combine_imputed_descriptives(age3_wealth3)
age3_wealth4_combined <-combine_imputed_descriptives(age3_wealth4)
age3_wealth5_combined <-combine_imputed_descriptives(age3_wealth5)

#calculate mean per group across imputed datasets: age 5
age5_wealth1 <- weighted_descriptives_imputed_datasets(wealth1, vocabulary_age5)
age5_wealth2 <- weighted_descriptives_imputed_datasets(wealth2, vocabulary_age5)
age5_wealth3 <- weighted_descriptives_imputed_datasets(wealth3, vocabulary_age5)
age5_wealth4 <- weighted_descriptives_imputed_datasets(wealth4, vocabulary_age5)
age5_wealth5 <- weighted_descriptives_imputed_datasets(wealth5, vocabulary_age5)
#combine descriptives across datasets to give poooled value: age 5
age5_wealth1_combined <- combine_imputed_descriptives(age5_wealth1)
age5_wealth2_combined <-combine_imputed_descriptives(age5_wealth2)
age5_wealth3_combined <-combine_imputed_descriptives(age5_wealth3)
age5_wealth4_combined <-combine_imputed_descriptives(age5_wealth4)
age5_wealth5_combined <-combine_imputed_descriptives(age5_wealth5)

#calculate mean per group across imputed datasets: age 11
age11_wealth1 <- weighted_descriptives_imputed_datasets(wealth1, vocabulary_age11)
age11_wealth2 <- weighted_descriptives_imputed_datasets(wealth2, vocabulary_age11)
age11_wealth3 <- weighted_descriptives_imputed_datasets(wealth3, vocabulary_age11)
age11_wealth4 <- weighted_descriptives_imputed_datasets(wealth4, vocabulary_age11)
age11_wealth5 <- weighted_descriptives_imputed_datasets(wealth5, vocabulary_age11)
#combine descriptives across datasets to give poooled value: age 11
age11_wealth1_combined <- combine_imputed_descriptives(age11_wealth1)
age11_wealth2_combined <-combine_imputed_descriptives(age11_wealth2)
age11_wealth3_combined <-combine_imputed_descriptives(age11_wealth3)
age11_wealth4_combined <-combine_imputed_descriptives(age11_wealth4)
age11_wealth5_combined <-combine_imputed_descriptives(age11_wealth5)

#calculate mean per group across imputed datasets: age 14
age14_wealth1 <- weighted_descriptives_imputed_datasets(wealth1, vocabulary_age14)
age14_wealth2 <- weighted_descriptives_imputed_datasets(wealth2, vocabulary_age14)
age14_wealth3 <- weighted_descriptives_imputed_datasets(wealth3, vocabulary_age14)
age14_wealth4 <- weighted_descriptives_imputed_datasets(wealth4, vocabulary_age14)
age14_wealth5 <- weighted_descriptives_imputed_datasets(wealth5, vocabulary_age14)
#combine descriptives across datasets to give poooled value: age 14
age14_wealth1_combined <- combine_imputed_descriptives(age14_wealth1)
age14_wealth2_combined <-combine_imputed_descriptives(age14_wealth2)
age14_wealth3_combined <-combine_imputed_descriptives(age14_wealth3)
age14_wealth4_combined <-combine_imputed_descriptives(age14_wealth4)
age14_wealth5_combined <-combine_imputed_descriptives(age14_wealth5)

#OCCUPATIONAL CLASS####
#separate out each occupation groups
occupation1 <- filter(long_format_mcs, occupational_status == "1") 
occupation2 <- filter(long_format_mcs, occupational_status == "2") 
occupation3 <- filter(long_format_mcs, occupational_status == "3") 
occupation4 <- filter(long_format_mcs, occupational_status == "4") 

#calculate mean per group across imputed datasets: age 3
age3_occupation1 <- weighted_descriptives_imputed_datasets(occupation1, vocabulary_age3)
age3_occupation2 <- weighted_descriptives_imputed_datasets(occupation2, vocabulary_age3)
age3_occupation3 <- weighted_descriptives_imputed_datasets(occupation3, vocabulary_age3)
age3_occupation4 <- weighted_descriptives_imputed_datasets(occupation4, vocabulary_age3)

#combine descriptives across datasets to give poooled value: age 3
age3_occupation1_combined <- combine_imputed_descriptives(age3_occupation1)
age3_occupation2_combined <- combine_imputed_descriptives(age3_occupation2)
age3_occupation3_combined <- combine_imputed_descriptives(age3_occupation3)
age3_occupation4_combined <- combine_imputed_descriptives(age3_occupation4)

#calculate mean per group across imputed datasets: age 5
age5_occupation1 <- weighted_descriptives_imputed_datasets(occupation1, vocabulary_age5)
age5_occupation2 <- weighted_descriptives_imputed_datasets(occupation2, vocabulary_age5)
age5_occupation3 <- weighted_descriptives_imputed_datasets(occupation3, vocabulary_age5)
age5_occupation4 <- weighted_descriptives_imputed_datasets(occupation4, vocabulary_age5)

#combine descriptives across datasets to give poooled value: age 5
age5_occupation1_combined <- combine_imputed_descriptives(age5_occupation1)
age5_occupation2_combined <- combine_imputed_descriptives(age5_occupation2)
age5_occupation3_combined <- combine_imputed_descriptives(age5_occupation3)
age5_occupation4_combined <- combine_imputed_descriptives(age5_occupation4)

#calculate mean per group across imputed datasets: age 11
age11_occupation1 <- weighted_descriptives_imputed_datasets(occupation1, vocabulary_age11)
age11_occupation2 <- weighted_descriptives_imputed_datasets(occupation2, vocabulary_age11)
age11_occupation3 <- weighted_descriptives_imputed_datasets(occupation3, vocabulary_age11)
age11_occupation4 <- weighted_descriptives_imputed_datasets(occupation4, vocabulary_age11)

#combine descriptives across datasets to give poooled value: age 11
age11_occupation1_combined <- combine_imputed_descriptives(age11_occupation1)
age11_occupation2_combined <- combine_imputed_descriptives(age11_occupation2)
age11_occupation3_combined <- combine_imputed_descriptives(age11_occupation3)
age11_occupation4_combined <- combine_imputed_descriptives(age11_occupation4)

#calculate mean per group across imputed datasets: age 14
age14_occupation1 <- weighted_descriptives_imputed_datasets(occupation1, vocabulary_age14)
age14_occupation2 <- weighted_descriptives_imputed_datasets(occupation2, vocabulary_age14)
age14_occupation3 <- weighted_descriptives_imputed_datasets(occupation3, vocabulary_age14)
age14_occupation4 <- weighted_descriptives_imputed_datasets(occupation4, vocabulary_age14)

#combine descriptives across datasets to give poooled value: age 14
age14_occupation1_combined <- combine_imputed_descriptives(age14_occupation1)
age14_occupation2_combined <- combine_imputed_descriptives(age14_occupation2)
age14_occupation3_combined <- combine_imputed_descriptives(age14_occupation3)
age14_occupation4_combined <- combine_imputed_descriptives(age14_occupation4)


#IMD####
#separate out each imd groups
imd1 <- filter(long_format_mcs, imd == "1") 
imd2 <- filter(long_format_mcs, imd == "2") 
imd3 <- filter(long_format_mcs, imd == "3") 
imd4 <- filter(long_format_mcs, imd == "4") 
imd5 <- filter(long_format_mcs, imd == "5") 
imd6 <- filter(long_format_mcs, imd == "6") 
imd7 <- filter(long_format_mcs, imd == "7") 
imd8 <- filter(long_format_mcs, imd == "8") 
imd9 <- filter(long_format_mcs, imd == "9") 
imd10 <- filter(long_format_mcs, imd == "10") 

#calculate mean per group across imputed datasets: age 3
age3_imd1 <- weighted_descriptives_imputed_datasets(imd1, vocabulary_age3)
age3_imd2 <- weighted_descriptives_imputed_datasets(imd2, vocabulary_age3)
age3_imd3 <- weighted_descriptives_imputed_datasets(imd3, vocabulary_age3)
age3_imd4 <- weighted_descriptives_imputed_datasets(imd4, vocabulary_age3)
age3_imd5 <- weighted_descriptives_imputed_datasets(imd5, vocabulary_age3)
age3_imd6 <- weighted_descriptives_imputed_datasets(imd6, vocabulary_age3)
age3_imd7 <- weighted_descriptives_imputed_datasets(imd7, vocabulary_age3)
age3_imd8 <- weighted_descriptives_imputed_datasets(imd8, vocabulary_age3)
age3_imd9 <- weighted_descriptives_imputed_datasets(imd9, vocabulary_age3)
age3_imd10 <- weighted_descriptives_imputed_datasets(imd10, vocabulary_age3)
#combine descriptives across datasets to give poooled value: age 3
age3_imd1_combined <- combine_imputed_descriptives(age3_imd1)
age3_imd2_combined <- combine_imputed_descriptives(age3_imd2)
age3_imd3_combined <- combine_imputed_descriptives(age3_imd3)
age3_imd4_combined <- combine_imputed_descriptives(age3_imd4)
age3_imd5_combined <- combine_imputed_descriptives(age3_imd5)
age3_imd6_combined <- combine_imputed_descriptives(age3_imd6)
age3_imd7_combined <- combine_imputed_descriptives(age3_imd7)
age3_imd8_combined <- combine_imputed_descriptives(age3_imd8)
age3_imd9_combined <- combine_imputed_descriptives(age3_imd9)
age3_imd10_combined <- combine_imputed_descriptives(age3_imd10)

#calculate mean per group across imputed datasets: age 5
age5_imd1 <- weighted_descriptives_imputed_datasets(imd1, vocabulary_age5)
age5_imd2 <- weighted_descriptives_imputed_datasets(imd2, vocabulary_age5)
age5_imd3 <- weighted_descriptives_imputed_datasets(imd3, vocabulary_age5)
age5_imd4 <- weighted_descriptives_imputed_datasets(imd4, vocabulary_age5)
age5_imd5 <- weighted_descriptives_imputed_datasets(imd5, vocabulary_age5)
age5_imd6 <- weighted_descriptives_imputed_datasets(imd6, vocabulary_age5)
age5_imd7 <- weighted_descriptives_imputed_datasets(imd7, vocabulary_age5)
age5_imd8 <- weighted_descriptives_imputed_datasets(imd8, vocabulary_age5)
age5_imd9 <- weighted_descriptives_imputed_datasets(imd9, vocabulary_age5)
age5_imd10 <- weighted_descriptives_imputed_datasets(imd10, vocabulary_age5)
#combine descriptives across datasets to give poooled value: age 3
age5_imd1_combined <- combine_imputed_descriptives(age5_imd1)
age5_imd2_combined <- combine_imputed_descriptives(age5_imd2)
age5_imd3_combined <- combine_imputed_descriptives(age5_imd3)
age5_imd4_combined <- combine_imputed_descriptives(age5_imd4)
age5_imd5_combined <- combine_imputed_descriptives(age5_imd5)
age5_imd6_combined <- combine_imputed_descriptives(age5_imd6)
age5_imd7_combined <- combine_imputed_descriptives(age5_imd7)
age5_imd8_combined <- combine_imputed_descriptives(age5_imd8)
age5_imd9_combined <- combine_imputed_descriptives(age5_imd9)
age5_imd10_combined <- combine_imputed_descriptives(age5_imd10)

#calculate mean per group across imputed datasets: age 11
age11_imd1 <- weighted_descriptives_imputed_datasets(imd1, vocabulary_age11)
age11_imd2 <- weighted_descriptives_imputed_datasets(imd2, vocabulary_age11)
age11_imd3 <- weighted_descriptives_imputed_datasets(imd3, vocabulary_age11)
age11_imd4 <- weighted_descriptives_imputed_datasets(imd4, vocabulary_age11)
age11_imd5 <- weighted_descriptives_imputed_datasets(imd5, vocabulary_age11)
age11_imd6 <- weighted_descriptives_imputed_datasets(imd6, vocabulary_age11)
age11_imd7 <- weighted_descriptives_imputed_datasets(imd7, vocabulary_age11)
age11_imd8 <- weighted_descriptives_imputed_datasets(imd8, vocabulary_age11)
age11_imd9 <- weighted_descriptives_imputed_datasets(imd9, vocabulary_age11)
age11_imd10 <- weighted_descriptives_imputed_datasets(imd10, vocabulary_age11)
#combine descriptives across datasets to give poooled value: age 3
age11_imd1_combined <- combine_imputed_descriptives(age11_imd1)
age11_imd2_combined <- combine_imputed_descriptives(age11_imd2)
age11_imd3_combined <- combine_imputed_descriptives(age11_imd3)
age11_imd4_combined <- combine_imputed_descriptives(age11_imd4)
age11_imd5_combined <- combine_imputed_descriptives(age11_imd5)
age11_imd6_combined <- combine_imputed_descriptives(age11_imd6)
age11_imd7_combined <- combine_imputed_descriptives(age11_imd7)
age11_imd8_combined <- combine_imputed_descriptives(age11_imd8)
age11_imd9_combined <- combine_imputed_descriptives(age11_imd9)
age11_imd10_combined <- combine_imputed_descriptives(age11_imd10)

#calculate mean per group across imputed datasets: age 14
age14_imd1 <- weighted_descriptives_imputed_datasets(imd1, vocabulary_age14)
age14_imd2 <- weighted_descriptives_imputed_datasets(imd2, vocabulary_age14)
age14_imd3 <- weighted_descriptives_imputed_datasets(imd3, vocabulary_age14)
age14_imd4 <- weighted_descriptives_imputed_datasets(imd4, vocabulary_age14)
age14_imd5 <- weighted_descriptives_imputed_datasets(imd5, vocabulary_age14)
age14_imd6 <- weighted_descriptives_imputed_datasets(imd6, vocabulary_age14)
age14_imd7 <- weighted_descriptives_imputed_datasets(imd7, vocabulary_age14)
age14_imd8 <- weighted_descriptives_imputed_datasets(imd8, vocabulary_age14)
age14_imd9 <- weighted_descriptives_imputed_datasets(imd9, vocabulary_age14)
age14_imd10 <- weighted_descriptives_imputed_datasets(imd10, vocabulary_age14)
#combine descriptives across datasets to give poooled value: age 3
age14_imd1_combined <- combine_imputed_descriptives(age14_imd1)
age14_imd2_combined <- combine_imputed_descriptives(age14_imd2)
age14_imd3_combined <- combine_imputed_descriptives(age14_imd3)
age14_imd4_combined <- combine_imputed_descriptives(age14_imd4)
age14_imd5_combined <- combine_imputed_descriptives(age14_imd5)
age14_imd6_combined <- combine_imputed_descriptives(age14_imd6)
age14_imd7_combined <- combine_imputed_descriptives(age14_imd7)
age14_imd8_combined <- combine_imputed_descriptives(age14_imd8)
age14_imd9_combined <- combine_imputed_descriptives(age14_imd9)
age14_imd10_combined <- combine_imputed_descriptives(age14_imd10)
```



now we want to put these results into one results table. 
first we need to prepare our data. 
to do this we will first put all descriptives into one dataframe, age 5 into another and so on.

```{r}
#nvq
age3_nvq0 <- slice_head(age3_NVQ0_combined)
row.names(age3_nvq0) <- c("age3_nvq0")
age3_nvq1 <- slice_head(age3_NVQ1_combined)
row.names(age3_nvq1) <- c("age3_nvq1")
age3_nvq2 <- slice_head(age3_NVQ2_combined)
row.names(age3_nvq2) <- c("age3_nvq2")
age3_nvq3 <- slice_head(age3_NVQ3_combined)
row.names(age3_nvq3) <- c("age3_nvq3")
age3_nvq4 <- slice_head(age3_NVQ4_combined)
row.names(age3_nvq4) <- c("age3_nvq4")
age3_nvq5 <- slice_head(age3_NVQ5_combined)
row.names(age3_nvq5) <- c("age3_nvq5")

#income
age3_income1 <- slice_head(age3_income1_combined)
row.names(age3_income1) <- c("age3_income1")
age3_income2 <- slice_head(age3_income2_combined)
row.names(age3_income2) <- c("age3_income2")
age3_income3 <- slice_head(age3_income3_combined)
row.names(age3_income3) <- c("age3_income3")
age3_income4 <- slice_head(age3_income4_combined)
row.names(age3_income4) <- c("age3_income4")
age3_income5 <- slice_head(age3_income5_combined)
row.names(age3_income5) <- c("age3_income5")

#wealth
age3_wealth1 <- slice_head(age3_wealth1_combined)
row.names(age3_wealth1) <- c("age3_wealth1")
age3_wealth2 <- slice_head(age3_wealth2_combined)
row.names(age3_wealth2) <- c("age3_wealth2")
age3_wealth3 <- slice_head(age3_wealth3_combined)
row.names(age3_wealth3) <- c("age3_wealth3")
age3_wealth4 <- slice_head(age3_wealth4_combined)
row.names(age3_wealth4) <- c("age3_wealth4")
age3_wealth5 <- slice_head(age3_wealth5_combined)
row.names(age3_wealth5) <- c("age3_wealth5")

#occupation
age3_occupation1 <- slice_head(age3_occupation1_combined)
row.names(age3_occupation1) <- c("age3_occupation1")
age3_occupation2 <- slice_head(age3_occupation2_combined)
row.names(age3_occupation2) <- c("age3_occupation2")
age3_occupation3 <- slice_head(age3_occupation3_combined)
row.names(age3_occupation3) <- c("age3_occupation3")
age3_occupation4 <- slice_head(age3_occupation4_combined)
row.names(age3_occupation4) <- c("age3_occupation4")

#imd
age3_imd1 <- slice_head(age3_imd1_combined)
row.names(age3_imd1) <- c("age3_imd1")
age3_imd2 <- slice_head(age3_imd2_combined)
row.names(age3_imd2) <- c("age3_imd2")
age3_imd3 <- slice_head(age3_imd3_combined)
row.names(age3_imd3) <- c("age3_imd3")
age3_imd4 <- slice_head(age3_imd4_combined)
row.names(age3_imd4) <- c("age3_imd4")
age3_imd5 <- slice_head(age3_imd5_combined)
row.names(age3_imd5) <- c("age3_imd5")
age3_imd6 <- slice_head(age3_imd6_combined)
row.names(age3_imd6) <- c("age3_imd6")
age3_imd7 <- slice_head(age3_imd7_combined)
row.names(age3_imd7) <- c("age3_imd7")
age3_imd8 <- slice_head(age3_imd8_combined)
row.names(age3_imd8) <- c("age3_imd8")
age3_imd9 <- slice_head(age3_imd9_combined)
row.names(age3_imd9) <- c("age3_imd9")
age3_imd10 <- slice_head(age3_imd10_combined)
row.names(age3_imd10) <- c("age3_imd10")


age3_descriptives <- rbind(age3_nvq0, age3_nvq1, age3_nvq2, age3_nvq3,age3_nvq4, age3_nvq5,
                           age3_income1, age3_income2, age3_income3, age3_income4, age3_income5,
                           age3_wealth1, age3_wealth2, age3_wealth3, age3_wealth4, age3_wealth5,
                           age3_occupation1, age3_occupation2, age3_occupation3, age3_occupation4,
                           age3_imd1, age3_imd2, age3_imd3,age3_imd4,age3_imd5,age3_imd6,age3_imd7,
                           age3_imd8,age3_imd9,age3_imd10)


#prepare data for table

age3_descriptives$Mean <- round(age3_descriptives$Mean, 2)
age3_descriptives$SD <- round(age3_descriptives$SD,2)
age3_descriptives$lower <- round(age3_descriptives$lower,2)
age3_descriptives$upper<- round(age3_descriptives$upper,2)
age3_descriptives$mean_sd = paste0(age3_descriptives$Mean, "(", age3_descriptives$SD, ")")
age3_descriptives$conf_int = paste0("[", age3_descriptives$lower, ";", age3_descriptives$upper, "]")

age3_descriptive_statistics <- age3_descriptives %>% 
  select(mean_sd, conf_int)

age3_descriptive_statistics$descriptives <- paste0(age3_descriptive_statistics$mean_sd,",", age3_descriptive_statistics$conf_int)


#age 5 

#nvq
age5_nvq0 <- slice_head(age5_NVQ0_combined)
row.names(age5_nvq0) <- c("age5_nvq0")
age5_nvq1 <- slice_head(age5_NVQ1_combined)
row.names(age5_nvq1) <- c("age5_nvq1")
age5_nvq2 <- slice_head(age5_NVQ2_combined)
row.names(age5_nvq2) <- c("age5_nvq2")
age5_nvq3 <- slice_head(age5_NVQ3_combined)
row.names(age5_nvq3) <- c("age5_nvq3")
age5_nvq4 <- slice_head(age5_NVQ4_combined)
row.names(age5_nvq4) <- c("age5_nvq4")
age5_nvq5 <- slice_head(age5_NVQ5_combined)
row.names(age5_nvq5) <- c("age5_nvq5")

#income
age5_income1 <- slice_head(age5_income1_combined)
row.names(age5_income1) <- c("age5_income1")
age5_income2 <- slice_head(age5_income2_combined)
row.names(age5_income2) <- c("age5_income2")
age5_income3 <- slice_head(age5_income3_combined)
row.names(age5_income3) <- c("age5_income3")
age5_income4 <- slice_head(age5_income4_combined)
row.names(age5_income4) <- c("age5_income4")
age5_income5 <- slice_head(age5_income5_combined)
row.names(age5_income5) <- c("age5_income5")

#wealth
age5_wealth1 <- slice_head(age5_wealth1_combined)
row.names(age5_wealth1) <- c("age5_wealth1")
age5_wealth2 <- slice_head(age5_wealth2_combined)
row.names(age5_wealth2) <- c("age5_wealth2")
age5_wealth3 <- slice_head(age5_wealth3_combined)
row.names(age5_wealth3) <- c("age5_wealth3")
age5_wealth4 <- slice_head(age5_wealth4_combined)
row.names(age5_wealth4) <- c("age5_wealth4")
age5_wealth5 <- slice_head(age5_wealth5_combined)
row.names(age5_wealth5) <- c("age5_wealth5")

#occupation
age5_occupation1 <- slice_head(age5_occupation1_combined)
row.names(age5_occupation1) <- c("age5_occupation1")
age5_occupation2 <- slice_head(age5_occupation2_combined)
row.names(age5_occupation2) <- c("age5_occupation2")
age5_occupation3 <- slice_head(age5_occupation3_combined)
row.names(age5_occupation3) <- c("age5_occupation3")
age5_occupation4 <- slice_head(age5_occupation4_combined)
row.names(age5_occupation4) <- c("age5_occupation4")

#imd
age5_imd1 <- slice_head(age5_imd1_combined)
row.names(age5_imd1) <- c("age5_imd1")
age5_imd2 <- slice_head(age5_imd2_combined)
row.names(age5_imd2) <- c("age5_imd2")
age5_imd3 <- slice_head(age5_imd3_combined)
row.names(age5_imd3) <- c("age5_imd3")
age5_imd4 <- slice_head(age5_imd4_combined)
row.names(age5_imd4) <- c("age5_imd4")
age5_imd5 <- slice_head(age5_imd5_combined)
row.names(age5_imd5) <- c("age5_imd5")
age5_imd6 <- slice_head(age5_imd6_combined)
row.names(age5_imd6) <- c("age5_imd6")
age5_imd7 <- slice_head(age5_imd7_combined)
row.names(age5_imd7) <- c("age5_imd7")
age5_imd8 <- slice_head(age5_imd8_combined)
row.names(age5_imd8) <- c("age5_imd8")
age5_imd9 <- slice_head(age5_imd9_combined)
row.names(age5_imd9) <- c("age5_imd9")
age5_imd10 <- slice_head(age5_imd10_combined)
row.names(age5_imd10) <- c("age5_imd10")


age5_descriptives <- rbind(age5_nvq0, age5_nvq1, age5_nvq2, age5_nvq3,age5_nvq4, age5_nvq5,
                           age5_income1, age5_income2, age5_income3, age5_income4, age5_income5,
                           age5_wealth1, age5_wealth2, age5_wealth3, age5_wealth4, age5_wealth5,
                           age5_occupation1, age5_occupation2, age5_occupation3, age5_occupation4,
                           age5_imd1, age5_imd2, age5_imd3,age5_imd4,age5_imd5,age5_imd6,age5_imd7,
                           age5_imd8,age5_imd9,age5_imd10)


#prepare data for table

age5_descriptives$Mean <- round(age5_descriptives$Mean, 2)
age5_descriptives$SD <- round(age5_descriptives$SD,2)
age5_descriptives$lower <- round(age5_descriptives$lower,2)
age5_descriptives$upper<- round(age5_descriptives$upper,2)
age5_descriptives$mean_sd = paste0(age5_descriptives$Mean, "(", age5_descriptives$SD, ")")
age5_descriptives$conf_int = paste0("[", age5_descriptives$lower, ";", age5_descriptives$upper, "]")

age5_descriptive_statistics <- age5_descriptives %>% 
  select(mean_sd, conf_int)

age5_descriptive_statistics$descriptives <- paste0(age5_descriptive_statistics$mean_sd,",", age5_descriptive_statistics$conf_int)

#age 11

#nvq
age11_nvq0 <- slice_head(age11_NVQ0_combined)
row.names(age11_nvq0) <- c("age11_nvq0")
age11_nvq1 <- slice_head(age11_NVQ1_combined)
row.names(age11_nvq1) <- c("age11_nvq1")
age11_nvq2 <- slice_head(age11_NVQ2_combined)
row.names(age11_nvq2) <- c("age11_nvq2")
age11_nvq3 <- slice_head(age11_NVQ3_combined)
row.names(age11_nvq3) <- c("age11_nvq3")
age11_nvq4 <- slice_head(age11_NVQ4_combined)
row.names(age11_nvq4) <- c("age11_nvq4")
age11_nvq5 <- slice_head(age11_NVQ5_combined)
row.names(age11_nvq5) <- c("age11_nvq5")

#income
age11_income1 <- slice_head(age11_income1_combined)
row.names(age11_income1) <- c("age11_income1")
age11_income2 <- slice_head(age11_income2_combined)
row.names(age11_income2) <- c("age11_income2")
age11_income3 <- slice_head(age11_income3_combined)
row.names(age11_income3) <- c("age11_income3")
age11_income4 <- slice_head(age11_income4_combined)
row.names(age11_income4) <- c("age11_income4")
age11_income5 <- slice_head(age11_income5_combined)
row.names(age11_income5) <- c("age11_income5")

#wealth
age11_wealth1 <- slice_head(age11_wealth1_combined)
row.names(age11_wealth1) <- c("age11_wealth1")
age11_wealth2 <- slice_head(age11_wealth2_combined)
row.names(age11_wealth2) <- c("age11_wealth2")
age11_wealth3 <- slice_head(age11_wealth3_combined)
row.names(age11_wealth3) <- c("age11_wealth3")
age11_wealth4 <- slice_head(age11_wealth4_combined)
row.names(age11_wealth4) <- c("age11_wealth4")
age11_wealth5 <- slice_head(age11_wealth5_combined)
row.names(age11_wealth5) <- c("age11_wealth5")

#occupation
age11_occupation1 <- slice_head(age11_occupation1_combined)
row.names(age11_occupation1) <- c("age11_occupation1")
age11_occupation2 <- slice_head(age11_occupation2_combined)
row.names(age11_occupation2) <- c("age11_occupation2")
age11_occupation3 <- slice_head(age11_occupation3_combined)
row.names(age11_occupation3) <- c("age11_occupation3")
age11_occupation4 <- slice_head(age11_occupation4_combined)
row.names(age11_occupation4) <- c("age11_occupation4")

#imd
age11_imd1 <- slice_head(age11_imd1_combined)
row.names(age11_imd1) <- c("age11_imd1")
age11_imd2 <- slice_head(age11_imd2_combined)
row.names(age11_imd2) <- c("age11_imd2")
age11_imd3 <- slice_head(age11_imd3_combined)
row.names(age11_imd3) <- c("age11_imd3")
age11_imd4 <- slice_head(age11_imd4_combined)
row.names(age11_imd4) <- c("age11_imd4")
age11_imd5 <- slice_head(age11_imd5_combined)
row.names(age11_imd5) <- c("age11_imd5")
age11_imd6 <- slice_head(age11_imd6_combined)
row.names(age11_imd6) <- c("age11_imd6")
age11_imd7 <- slice_head(age11_imd7_combined)
row.names(age11_imd7) <- c("age11_imd7")
age11_imd8 <- slice_head(age11_imd8_combined)
row.names(age11_imd8) <- c("age11_imd8")
age11_imd9 <- slice_head(age11_imd9_combined)
row.names(age11_imd9) <- c("age11_imd9")
age11_imd10 <- slice_head(age11_imd10_combined)
row.names(age11_imd10) <- c("age11_imd10")


age11_descriptives <- rbind(age11_nvq0, age11_nvq1, age11_nvq2, age11_nvq3,age11_nvq4, age11_nvq5,
                           age11_income1, age11_income2, age11_income3, age11_income4, age11_income5,
                           age11_wealth1, age11_wealth2, age11_wealth3, age11_wealth4, age11_wealth5,
                           age11_occupation1, age11_occupation2, age11_occupation3, age11_occupation4,
                           age11_imd1, age11_imd2, age11_imd3,age11_imd4,age11_imd5,age11_imd6,age11_imd7,
                           age11_imd8,age11_imd9,age11_imd10)


#prepare data for table

age11_descriptives$Mean <- round(age11_descriptives$Mean, 2)
age11_descriptives$SD <- round(age11_descriptives$SD,2)
age11_descriptives$lower <- round(age11_descriptives$lower,2)
age11_descriptives$upper<- round(age11_descriptives$upper,2)
age11_descriptives$mean_sd = paste0(age11_descriptives$Mean, "(", age11_descriptives$SD, ")")
age11_descriptives$conf_int = paste0("[", age11_descriptives$lower, ";", age11_descriptives$upper, "]")

age11_descriptive_statistics <- age11_descriptives %>% 
  select(mean_sd, conf_int)

age11_descriptive_statistics$descriptives <- paste0(age11_descriptive_statistics$mean_sd,",", age11_descriptive_statistics$conf_int)


#age 14

#nvq
age14_nvq0 <- slice_head(age14_NVQ0_combined)
row.names(age14_nvq0) <- c("age14_nvq0")
age14_nvq1 <- slice_head(age14_NVQ1_combined)
row.names(age14_nvq1) <- c("age14_nvq1")
age14_nvq2 <- slice_head(age14_NVQ2_combined)
row.names(age14_nvq2) <- c("age14_nvq2")
age14_nvq3 <- slice_head(age14_NVQ3_combined)
row.names(age14_nvq3) <- c("age14_nvq3")
age14_nvq4 <- slice_head(age14_NVQ4_combined)
row.names(age14_nvq4) <- c("age14_nvq4")
age14_nvq5 <- slice_head(age14_NVQ5_combined)
row.names(age14_nvq5) <- c("age14_nvq5")

#income
age14_income1 <- slice_head(age14_income1_combined)
row.names(age14_income1) <- c("age14_income1")
age14_income2 <- slice_head(age14_income2_combined)
row.names(age14_income2) <- c("age14_income2")
age14_income3 <- slice_head(age14_income3_combined)
row.names(age14_income3) <- c("age14_income3")
age14_income4 <- slice_head(age14_income4_combined)
row.names(age14_income4) <- c("age14_income4")
age14_income5 <- slice_head(age14_income5_combined)
row.names(age14_income5) <- c("age14_income5")

#wealth
age14_wealth1 <- slice_head(age14_wealth1_combined)
row.names(age14_wealth1) <- c("age14_wealth1")
age14_wealth2 <- slice_head(age14_wealth2_combined)
row.names(age14_wealth2) <- c("age14_wealth2")
age14_wealth3 <- slice_head(age14_wealth3_combined)
row.names(age14_wealth3) <- c("age14_wealth3")
age14_wealth4 <- slice_head(age14_wealth4_combined)
row.names(age14_wealth4) <- c("age14_wealth4")
age14_wealth5 <- slice_head(age14_wealth5_combined)
row.names(age14_wealth5) <- c("age14_wealth5")

#occupation
age14_occupation1 <- slice_head(age14_occupation1_combined)
row.names(age14_occupation1) <- c("age14_occupation1")
age14_occupation2 <- slice_head(age14_occupation2_combined)
row.names(age14_occupation2) <- c("age14_occupation2")
age14_occupation3 <- slice_head(age14_occupation3_combined)
row.names(age14_occupation3) <- c("age14_occupation3")
age14_occupation4 <- slice_head(age14_occupation4_combined)
row.names(age14_occupation4) <- c("age14_occupation4")

#imd
age14_imd1 <- slice_head(age14_imd1_combined)
row.names(age14_imd1) <- c("age14_imd1")
age14_imd2 <- slice_head(age14_imd2_combined)
row.names(age14_imd2) <- c("age14_imd2")
age14_imd3 <- slice_head(age14_imd3_combined)
row.names(age14_imd3) <- c("age14_imd3")
age14_imd4 <- slice_head(age14_imd4_combined)
row.names(age14_imd4) <- c("age14_imd4")
age14_imd5 <- slice_head(age14_imd5_combined)
row.names(age14_imd5) <- c("age14_imd5")
age14_imd6 <- slice_head(age14_imd6_combined)
row.names(age14_imd6) <- c("age14_imd6")
age14_imd7 <- slice_head(age14_imd7_combined)
row.names(age14_imd7) <- c("age14_imd7")
age14_imd8 <- slice_head(age14_imd8_combined)
row.names(age14_imd8) <- c("age14_imd8")
age14_imd9 <- slice_head(age14_imd9_combined)
row.names(age14_imd9) <- c("age14_imd9")
age14_imd10 <- slice_head(age14_imd10_combined)
row.names(age14_imd10) <- c("age14_imd10")


age14_descriptives <- rbind(age14_nvq0, age14_nvq1, age14_nvq2, age14_nvq3,age14_nvq4, age14_nvq5,
                           age14_income1, age14_income2, age14_income3, age14_income4, age14_income5,
                           age14_wealth1, age14_wealth2, age14_wealth3, age14_wealth4, age14_wealth5,
                           age14_occupation1, age14_occupation2, age14_occupation3, age14_occupation4,
                           age14_imd1, age14_imd2, age14_imd3,age14_imd4,age14_imd5,age14_imd6,age14_imd7,
                           age14_imd8,age14_imd9,age14_imd10)


#prepare data for table

age14_descriptives$Mean <- round(age14_descriptives$Mean, 2)
age14_descriptives$SD <- round(age14_descriptives$SD,2)
age14_descriptives$lower <- round(age14_descriptives$lower,2)
age14_descriptives$upper<- round(age14_descriptives$upper,2)
age14_descriptives$mean_sd = paste0(age14_descriptives$Mean, "(", age14_descriptives$SD, ")")
age14_descriptives$conf_int = paste0("[", age14_descriptives$lower, ";", age14_descriptives$upper, "]")

age14_descriptive_statistics <- age14_descriptives %>% 
  select(mean_sd, conf_int)

age14_descriptive_statistics$descriptives <- paste0(age14_descriptive_statistics$mean_sd,",", age14_descriptive_statistics$conf_int)

```

now that we have 4 datasets with descriptives for each age, we want to pull out the relevant stats to start to formulate our table.
our dataframes are called:
*age3_descriptive_statistics
*age5_descriptive_statistics
*age11_descriptive_statistics
*age14_descriptive_statistics


```{r}
#first of all, we just need the column called "descriptives" from each age dataframe. 
age3_descriptive_statistics$indicator <- c("Parent education \n (none of these/overseas)", "Parent education \n (NVQ1)", 
                                     "Parent education \n (NVQ2)", "Parent education \n (NVQ3)", 
                                     "Parent education \n (NVQ4)", "Parent education \n (NVQ5)",
                                     "Income \n  (quntile 1)", "Income \n  (quntile 2)", "Income \n  (quntile 3)",
                                     "Income \n  (quntile 4)", "Income \n  (quntile 5)", "Wealth \n  (quntile 1)",
                                     "Wealth \n  (quntile 2)", "Wealth \n  (quntile 3)", "Wealth \n  (quntile 4)", 
                                     "Wealth \n  (quntile 5)", "Occupational Status \n (Unemployed)", 
                                     "Occupational Status \n (Routine)", "Occupational Status \n (Intermediate)",
                                     "Occupational Status \n (higher managerial)", "Relative neighbourhood deprivation \n (most deprived)",
                                     "Relative neighbourhood deprivation \n (10 - < 20%)",  "Relative neighbourhood deprivation \n (20 - < 30%)",
                                      "Relative neighbourhood deprivation \n (30 - < 40%)",  "Relative neighbourhood deprivation \n (40 - < 50%)",
                                      "Relative neighbourhood deprivation \n (50 - < 60%)",  "Relative neighbourhood deprivation \n (60 - < 70%)",
                                      "Relative neighbourhood deprivation \n (70 - < 80%)",  "Relative neighbourhood deprivation \n (80 - < 90%)",
                                      "Relative neighbourhood deprivation \n (least deprived)"
                                     )


age5_descriptive_statistics$indicator <- c("Parent education \n (none of these/overseas)", "Parent education \n (NVQ1)", 
                                      "Parent education \n (NVQ2)", "Parent education \n (NVQ3)", 
                                      "Parent education \n (NVQ4)", "Parent education \n (NVQ5)",
                                      "Income \n  (quntile 1)", "Income \n  (quntile 2)", "Income \n  (quntile 3)",
                                      "Income \n  (quntile 4)", "Income \n  (quntile 5)", "Wealth \n  (quntile 1)",
                                      "Wealth \n  (quntile 2)", "Wealth \n  (quntile 3)", "Wealth \n  (quntile 4)", 
                                      "Wealth \n  (quntile 5)", "Occupational Status \n (Unemployed)", 
                                      "Occupational Status \n (Routine)", "Occupational Status \n (Intermediate)",
                                      "Occupational Status \n (higher managerial)", "Relative neighbourhood deprivation \n (most deprived)",
                                      "Relative neighbourhood deprivation \n (10 - < 20%)",  "Relative neighbourhood deprivation \n (20 - < 30%)",
                                      "Relative neighbourhood deprivation \n (30 - < 40%)",  "Relative neighbourhood deprivation \n (40 - < 50%)",
                                      "Relative neighbourhood deprivation \n (50 - < 60%)",  "Relative neighbourhood deprivation \n (60 - < 70%)",
                                      "Relative neighbourhood deprivation \n (70 - < 80%)",  "Relative neighbourhood deprivation \n (80 - < 90%)",
                                      "Relative neighbourhood deprivation \n (least deprived)"
)


age11_descriptive_statistics$indicator <- c("Parent education \n (none of these/overseas)", "Parent education \n (NVQ1)", 
                                      "Parent education \n (NVQ2)", "Parent education \n (NVQ3)", 
                                      "Parent education \n (NVQ4)", "Parent education \n (NVQ5)",
                                      "Income \n  (quntile 1)", "Income \n  (quntile 2)", "Income \n  (quntile 3)",
                                      "Income \n  (quntile 4)", "Income \n  (quntile 5)", "Wealth \n  (quntile 1)",
                                      "Wealth \n  (quntile 2)", "Wealth \n  (quntile 3)", "Wealth \n  (quntile 4)", 
                                      "Wealth \n  (quntile 5)", "Occupational Status \n (Unemployed)", 
                                      "Occupational Status \n (Routine)", "Occupational Status \n (Intermediate)",
                                      "Occupational Status \n (higher managerial)", "Relative neighbourhood deprivation \n (most deprived)",
                                      "Relative neighbourhood deprivation \n (10 - < 20%)",  "Relative neighbourhood deprivation \n (20 - < 30%)",
                                      "Relative neighbourhood deprivation \n (30 - < 40%)",  "Relative neighbourhood deprivation \n (40 - < 50%)",
                                      "Relative neighbourhood deprivation \n (50 - < 60%)",  "Relative neighbourhood deprivation \n (60 - < 70%)",
                                      "Relative neighbourhood deprivation \n (70 - < 80%)",  "Relative neighbourhood deprivation \n (80 - < 90%)",
                                      "Relative neighbourhood deprivation \n (least deprived)"
)


age14_descriptive_statistics$indicator  <- c("Parent education \n (none of these/overseas)", "Parent education \n (NVQ1)", 
                                      "Parent education \n (NVQ2)", "Parent education \n (NVQ3)", 
                                      "Parent education \n (NVQ4)", "Parent education \n (NVQ5)",
                                      "Income \n  (quntile 1)", "Income \n  (quntile 2)", "Income \n  (quntile 3)",
                                      "Income \n  (quntile 4)", "Income \n  (quntile 5)", "Wealth \n  (quntile 1)",
                                      "Wealth \n  (quntile 2)", "Wealth \n  (quntile 3)", "Wealth \n  (quntile 4)", 
                                      "Wealth \n  (quntile 5)", "Occupational Status \n (Unemployed)", 
                                      "Occupational Status \n (Routine)", "Occupational Status \n (Intermediate)",
                                      "Occupational Status \n (higher managerial)", "Relative neighbourhood deprivation \n (most deprived)",
                                      "Relative neighbourhood deprivation \n (10 - < 20%)",  "Relative neighbourhood deprivation \n (20 - < 30%)",
                                      "Relative neighbourhood deprivation \n (30 - < 40%)",  "Relative neighbourhood deprivation \n (40 - < 50%)",
                                      "Relative neighbourhood deprivation \n (50 - < 60%)",  "Relative neighbourhood deprivation \n (60 - < 70%)",
                                      "Relative neighbourhood deprivation \n (70 - < 80%)",  "Relative neighbourhood deprivation \n (80 - < 90%)",
                                      "Relative neighbourhood deprivation \n (least deprived)"
)


new_descriptives_age3 <- age3_descriptive_statistics %>% 
  select(indicator, descriptives) 
new_descriptives_age5 <- age5_descriptive_statistics %>% 
  select(indicator,descriptives) 
new_descriptives_age11 <- age11_descriptive_statistics %>% 
  select(indicator,descriptives) 
new_descriptives_age14 <- age14_descriptive_statistics %>% 
  select(indicator, descriptives)

row.names(new_descriptives_age3) <- c(1:30)
row.names(new_descriptives_age5) <- c(1:30)
row.names(new_descriptives_age11) <- c(1:30)
row.names(new_descriptives_age14) <- c(1:30)

names(new_descriptives_age3) <- c( "Indicator","Age3")
names(new_descriptives_age5) <- c("Indicator", "Age5")
names(new_descriptives_age11) <- c( "Indicator", "Age11")
names(new_descriptives_age14) <- c( "Indicator", "Age14")


#put this into one dataframe

lang_descriptives1 = data.frame(new_descriptives_age3, new_descriptives_age5, new_descriptives_age11, new_descriptives_age14)
language_descriptives = lang_descriptives1 %>% 
  select(Indicator, Age3, Age5, Age11, Age14)

```


Create table with Flextabls
```{r}

#put into table
#define border
my_border = border= fp_border(color="black", width=1)
language_sesDescriptives <- language_descriptives %>% 
  flextable() %>% 
  font(fontname = "Times New Roman", part="all") %>% #
  fontsize(size=10, part = "all") %>% #
  align(j=1, align="left", part="all") %>% 
  align(j=1:5, align="center", part="all") %>% 
  color(j=1:5, color="black", part="all") %>% 
  width(j=1, width=2) %>% 
  width(j=2:5, width=1.8) %>% 
  line_spacing(j=2:5, space=1.5) %>% 
  line_spacing(j=1, space=1.5) %>% 
  border_remove() %>% 
  hline_top(j=1:5, part="all", border=my_border) %>% 
  hline_bottom(j=1:5,part="body",  border=my_border) %>% 
  set_header_labels(`Indicator`= "SEC Indicator", `Age3` = "Age 3 Vocabulary", 
                    `Age5` = "Age 5 Vocabulary", `Age11` = "Age 11 Vocabulary", 
                    `Age14` = "Age 14 Vocabulary") %>% 
  #add_header_row(values = c(" ", "Proportion (%) or \n Mean(±SD) [95% CIs]" ), colwidths = c(2,5)) %>% 
  font(fontname = "Times New Roman", part="header") %>% 
  align(align="center", part="header") %>% 
  hline_top(j = 2:5, part = "all", border = my_border)  %>% 
  font(fontname = "Times New Roman", part = "footer") %>% 
  fontsize(size = 9, part = "footer") %>% 
  italic(part = "footer", italic = TRUE) %>% 
  align(align="left", part="footer") %>% 
  #add_header_lines(values = c("Table 2: Descriptive Statistics for Analytical Sample (N = 17, 070) and Whole MCS2001 Cohort (N=19,243)")) %>% 
  font(fontname = "Times New Roman", part = "header") %>% 
  fontsize(size = 12, part = "header") %>% 
  italic(part = "header", italic = TRUE)
  

 print(full_descriptives, preview = "docx") 





```


